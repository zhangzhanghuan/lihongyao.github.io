export {loaddingGoodsList, scroll}

function loaddingGoodsList(response, $box) {
    let goodsStr = "";
    let data = response.contents;
    data.forEach(obj => {
        goodsStr += `<li class="goods-box">
            ${(function(){
                let arr = null;
                let contentStr = `<div class="tab-content">`;
                let arrowLeft = `<i class="iconfont icon-arrow1"></i>`;
                let arrowRight = `<i class="iconfont icon-arrow"></i>`;
                let tabStr = `<div class="tab-menu"><div class="view-box">`;
                obj.colorImg.forEach(img => {
                    contentStr += `<img src="${img}" alt="${obj.name}">`;
                    tabStr += `<img src="${img}" alt="${obj.name}">`;
                });
                contentStr +=`</div>`;
                tabStr +=`</div></div>`;
                arr = [contentStr, arrowLeft, tabStr, arrowRight];
                return arr.join("");
            })()}
            <p class="goods-name">${obj.name}</p>
            ${isExit(obj.des, "goods-des")}
            <p class="goods-price">￥ <span class="price-num">${parseInt(obj.price)}</span> 起</p>
            <span class="contrast">对比</span>
        </li>`;
    });
    $box.html(goodsStr);

    // 判断JSON数据是否存在,存在则添加HTML标签和样式,否则不添加
    function isExit(str, className) {
        if(str) {
            return `<p class=${className}>${str}</p>`;
        }else {
            return "";
        }
    }
}

function scroll() {
    $('.tab-menu').each(function(index, element) {
        console.log($(element).siblings('.iconfont'));
        if($(element).find('img').length > 4) {
            $(element).siblings('.iconfont').addClass('show')
        }else {return;}
    });
    $('.icon-arrow1').on('click', function(){
        let father = $(this).next().children('.view-box');
        let sons = father.children();
        if( sons.length > 4) {
            father.animate({left: "0"}, 300);
        }else {return;}
    });
    $('.icon-arrow').on('click', function(){
        let father = $(this).prev().children('.view-box');
        let sons = father.children();
        if( sons.length > 4) {
            father.animate({left: "-192px"}, 300);
        }else {return;}
    });
}
