require('../less/common.less');
require('../less/goods.less');
import './common';
import {
    loaddingKeywordsList,
    loaddingGoodsList,
    scroll,
    tabChange,
    hasStock,
} from './goods-func';

// 禁止热更新刷新页面
if (module.hot) {
    module.hot.accept();
}

$(function () {
    var words = {
        "classify": "",
        "size": "",
        "wear": "",
        "type": "",
        "spec": "",
        "microphone": "",
        "way": "",
        "bluetooth": ""
    }
    var keyword = "";
    var keywordsClass = "";
    var _title = "";
    /****************** 商品数据处理 **********************/
    $.ajax({
        url: '../json/data.json',
        success: (function (respon) {
            loaddingGoodsList(respon, "手机", words);
            tabChange();
            scroll();
            hasStock();
            // 同步更新图片
            $('.content').on('click', '.keywords', function(e){
                // 获取被点击元素的Class, 根据第一个Class判断其属于JSON数据的哪种属性
                keywordsClass = $(e.target).attr('class').split(" ")[0];
                // 被点击元素的文本筛入words对象
                words[`${keywordsClass}`] = $(e.target).text() === "全部" ? "" : $(e.target).text();
                loaddingGoodsList(respon, "手机", words);
                tabChange();
                scroll();
            });
            $('.content').on('click', '.title', function(e){
                _title = $(e.target).text();
                loaddingGoodsList(respon, _title, words);
                tabChange();
                scroll();
            })
        })
    });

    /****************** 过滤关键词数据处理 *******************/
    $.ajax({
        url: '../json/keywords.json',
        success: (function (response) {
            loaddingKeywordsList(response, "手机");
            // 点击更新关键字
            $('.content').on('click', '.keywords', function(e){
                // 被点击元素改变颜色
                $(this).addClass('checked').siblings('.keywords').removeClass('checked');
                // 获取被点击元素文本
                keyword = $(e.target).text();
                loaddingKeywordsList(response, keyword);
            });
        })
    });

















});
