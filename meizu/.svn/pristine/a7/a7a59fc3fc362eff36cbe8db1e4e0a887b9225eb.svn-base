require("../less/common.less");
import './common';
require("../less/details.less");
$.ajax({
    url:"../json/index.json",
    success:function(obj){
        let data = JSON.parse(sessionStorage.book);
        console.log(data);
        $(".con").html(`
        <div class="container">
                        
                            <span>
                                ${data.name}
                            </span>
                            <ul>
                                <li>
                                    <a href="">首页</a>
                                </li>
                                <li>
                                        <a href="">概述</a>
                                </li>
                                <li>
                                    <a href="">性能</a>
                                </li>
                                <li>
                                    <a href="">相机</a>
                                </li>
                                <li>
                                    <a href="">参数</a>
                                </li>
                                <li>
                                    <a href="">常见问题</a>
                                </li>
                            </ul>
                       
                    </div>
                   <div class="con-clor">
                        <section class="container-row">
                                <div class="left-container">
                                        <div class="container-img">
                                               ${(function(){
                                                   let restr="";
                                                   data.img.forEach(function(res){
                                                       restr+=`
                                                       <img src="${res}">
                                                       `
                                                   })
                                                   return restr;
                                               })()}       
                                            </div>
                                            <ul class="small-img">
                                               ${(function(){
                                                   let imgstr="";
                                                   data.img.forEach(function(img){
                                                       imgstr+=`
                                                       <li>
                                                       <img src="${img}" alt="">
                                                   </li>
                                                       `
                                                   })
                                                   return imgstr;
                                               })()}
                                                
                                            </ul>
                                </div>
                                <div class="right-container">
                                    <div class="right-text">
                                        <h1>${data.name}</h1>
                                        <p>${data.des}</p>
                                    </div>
                                    <div class="right-price">
                                        <span class="right-price-small">￥</span>
                                        <span class="money">${data.price}</span>
                                    </div>
                                    <div class="div-server">
                                        <div class="vm">
                                            <span>支持</span>
                                            <span>
                                            <i class="iconfont icon-success"></i>
                                            花呗分期
                                            </span>
                                            <span>
                                            <i class="iconfont icon-success"></i>
                                                    顺丰发货
                                            </span>
                                            <span>
                                            <i class="iconfont icon-success"></i>
                                                    7天无理由退货
                                            </span>
                                        </div>
                                        <div class="vm-server">
                                            <span>配送服务</span>
                                            <span>四川省</span>
                                            <span>成都市</span>
                                            <p>
                                                本商品由 魅族 负责发货并提供售后服务
                                                <span class="kefu">
                                                <i class="iconfont icon-kefu"></i>
                                                    在线客服
                                                </span>
                                            </p>
                                        </div>
                                        </div>
                                        <div class="type type-one">
                                            <span>型号</span>
                                            <span>${data.name}</span>
                                        </div>
                                        <div class="type">
                                            <span>网络类型</span>
                                            <span>全网公开版</span>
                                        </div>
                                        <div class="type type-color">
                                            <span>颜色分类</span>
                                           ${(function(){
                                               let colorstr="";
                                               data.color.forEach(function(col){
                                                   colorstr+=`
                                                   <span>${col}</span>
                                                   `
                                               })
                                               return colorstr;
                                           })()}
                                        </div>
                                        <div class="type type-color">
                                            <span>内存容量</span>
                                            
                                            ${(function(){
                                                let specstr="";
                                                if(data.spec){
                                                    data.spec.forEach(function(spec){
                                                        specstr+=`
                                                        <span>${spec}</span>
                                                        `
                                                    })
                                                    return specstr;
                                                }else{
                                                    return "";
                                                }
                                            })()}
                                        </div>
                                        <div class="type">
                                            <span>选择套餐</span>
                                            <span>官方标配</span>
                                        </div>
                                        <div class="type-num">
                                            <span>数量</span>
                                            <span> - </span>
                                            <input type="text" value="1">
                                            <span> + </span>
                                        </div>
                                        <div class="once">
                                            <button class="">立即购买</button>
                                            <button class="add-shop">加入购物车</button>
                                        </div>
                                    </div>
                            </section>
                   </div>
        `)
        //添加购物车
    $(".add-shop").click(function(){
        let order = {
            "name": data.name,
            "price": data.price,
            "num": 1,
            "color":data.color[0],
            "img": data.img[0],
            "spec":data.spec[0]
        };
        
        let rootArr = [];
        // 如果本地存在订单数据，则根据本地数据更新rootArr
        if(localStorage.orders) {
            rootArr = JSON.parse(localStorage.orders);
        }
        // 更新本地数据
        rootArr.push(order);
        console.log(rootArr)
        localStorage.orders = JSON.stringify(rootArr);
        location.href="./shopcarts.html"
    })
    }
})
